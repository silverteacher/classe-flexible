<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission Beatles - Classe Flexible</title>
    <style>
    * {
        box-sizing:border-box
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 1em;
        background: linear-gradient(135deg, #4A90E2 0%, #5B6FB5 100%);
        color: #222;
        font-size: 16px;
        line-height: 1.6;
        max-width: 1200px;
        margin:0 auto
    }

    .mission-intro {
        background: white;
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        position: relative;
        border:3px solid #4A90E2;
        overflow: hidden;
    }

    /* IMAGE DE FOND BEATLES */
    .mission-intro::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 80%;
        height: 80%;
        background-image: url('https://upload.wikimedia.org/wikipedia/commons/9/9f/Beatles_ad_1965_just_the_beatles_crop.jpg');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        opacity: 0.08;
        z-index: 0;
        pointer-events: none;
    }

    .mission-intro > * {
        position: relative;
        z-index: 1;
    }

    .mission-intro h1 {
        text-align: center;
        color: #4A90E2;
        font-size: 2.2em;
        margin-bottom: 20px;
        text-shadow:1px 1px 2px rgba(0, 0, 0, 0.1)
    }

    .beatles-header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        margin-bottom: 25px;
        flex-wrap:wrap
    }

    .music-icon {
        font-size: 3em;
        animation:pulse 2s ease-in-out infinite
    }

    @keyframes pulse {
        0%, 100% {
            transform:scale(1)
        }

        50% {
            transform:scale(1.1)
        }
    }

    .beatles-silhouette {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin:20px 0
    }

    .beatle {
        width: 60px;
        height: 80px;
        background: linear-gradient(180deg, #5B6FB5 0%, #4A90E2 100%);
        border-radius: 50% 50% 0 0;
        position: relative;
        animation:walk 1.5s ease-in-out infinite
    }

    .beatle:nth-child(1) {
        animation-delay:0s
    }

    .beatle:nth-child(2) {
        animation-delay:0.2s
    }

    .beatle:nth-child(3) {
        animation-delay:0.4s
    }

    .beatle:nth-child(4) {
        animation-delay:0.6s
    }

    @keyframes walk {
        0%, 100% {
            transform:translateY(0)
        }

        50% {
            transform:translateY(-5px)
        }
    }

    .mission-text {
        background: #F0F7FF;
        padding: 20px;
        border-radius: 12px;
        border-left: 5px solid #4A90E2;
        font-size: 1.05em;
        line-height:1.8
    }

    .mission-text strong {
        color: #4A90E2;
        font-size:1.1em
    }

    .mission-text ul {
        margin: 15px 0;
        padding-left:25px
    }

    .mission-text li {
        margin:8px 0
    }

    .timer-section {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 8px 30px rgba(74, 144, 226, 0.3);
        border: 3px solid #4A90E2;
        text-align:center
    }

    .timer-display {
        font-size: 3.5em;
        font-weight: bold;
        color: #4A90E2;
        margin: 20px 0;
        font-family: 'Courier New', monospace;
        text-shadow:2px 2px 4px rgba(0, 0, 0, 0.1)
    }

    .timer-display.warning {
        color: #FF8C00;
        animation:blink 1s ease-in-out infinite
    }

    .timer-display.danger {
        color: #E74C3C;
        animation:blink 0.5s ease-in-out infinite
    }

    @keyframes blink {
        0%, 100% {
            opacity:1
        }

        50% {
            opacity:0.7
        }
    }

    .timer-controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top:20px
    }

    .timer-controls button {
        background: #4A90E2;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 1.1em;
        font-weight: 600;
        cursor: pointer;
        transition:all 0.3s ease
    }

    .timer-controls button:hover {
        background: #3A7BC8;
        transform:translateY(-2px)
    }

    .timer-controls button:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform:none
    }

    .timer-controls button.pause-btn {
        background:#FFA94D
    }

    .timer-controls button.pause-btn:hover {
        background:#FF8C00
    }

    .timer-controls button.reset-btn {
        background:#666
    }

    .timer-controls button.reset-btn:hover {
        background:#555
    }

    .indice-section {
        background: linear-gradient(135deg, #FFA94D 0%, #FFB366 100%);
        border-radius: 20px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 8px 30px rgba(255, 169, 77, 0.3);
        border:3px solid #F79A3E
    }

    .indice-header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin-bottom:20px
    }

    .indice-header h2 {
        color: white;
        font-size: 1.8em;
        margin: 0;
        text-shadow:2px 2px 4px rgba(0, 0, 0, 0.2)
    }

    .escape-icon {
        font-size: 2.5em;
        animation:bounce 2s ease-in-out infinite
    }

    @keyframes bounce {
        0%, 100% {
            transform:translateY(0)
        }

        50% {
            transform:translateY(-10px)
        }
    }

    .indice-content {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow:0 4px 15px rgba(0, 0, 0, 0.15)
    }

    .indice-content p {
        font-size: 1.1em;
        color: #333;
        margin: 10px 0;
        line-height:1.8
    }

    .indice-content strong {
        color: #F79A3E;
        font-size:1.15em
    }

    .indice-warning {
        background: #FFF4E6;
        color: #9A6324;
        padding: 12px;
        border-radius: 8px;
        border-left: 4px solid #FFA94D;
        margin-top: 15px;
        font-style:italic
    }

    .container {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow:0 5px 25px rgba(0, 0, 0, 0.15)
    }

    h1 {
        font-size: 2em;
        margin-bottom: 0.3em;
        color:#4A90E2
    }

    h2 {
        font-size: 1.5em;
        margin-bottom: 0.8em;
        color:#333
    }

    h3 {
        font-size: 1.2em;
        color:#555
    }

    .progression {
        margin-bottom: 30px;
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap:wrap
    }

    .step {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        border: 3px solid #4A90E2;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #fff;
        opacity: 0.5;
        font-size: 1.3em;
        font-weight: bold;
        transition:all 0.3s ease
    }

    .step.active {
        background: #4A90E2;
        color: #fff;
        opacity: 1;
        transform: scale(1.1);
        box-shadow:0 4px 15px rgba(74, 144, 226, 0.4)
    }

    .section {
        border-radius: 15px;
        background: #F8FBFF;
        margin-bottom: 30px;
        padding: 25px 30px;
        box-shadow:0 3px 15px rgba(0, 0, 0, 0.08)
    }

    label {
        font-weight: 600;
        font-size: 1.1em;
        display: block;
        margin-bottom: 10px;
        color: #333
    }

    input[type="text"], textarea {
        width: 100%;
        margin-bottom: 12px;
        padding: 10px 12px;
        border-radius: 8px;
        border: 2px solid #B8D4F1;
        font-size: 1em;
        transition: border-color 0.3s ease
    }

    input[type="text"]:focus, textarea:focus {
        outline: none;
        border-color:#4A90E2
    }

    button {
        margin-top: 8px;
        background: #4A90E2;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px 24px;
        cursor: pointer;
        font-size: 1em;
        font-weight: 600;
        transition:background 0.3s ease, transform 0.2s ease
    }

    button:hover {
        background: #3A7BC8;
        transform:translateY(-2px)
    }

    button:disabled {
        background: #ccc !important;
        cursor: not-allowed !important;
        transform: none !important;
        opacity: 0.6 !important;
    }

    .btn-success {
        background:#50C878
    }

    .btn-success:hover {
        background:#3FB264
    }

    .error {
        color: #E74C3C;
        font-weight: bold;
        font-size: 1em;
        margin-top: 10px;
    }

    .success {
        color: #50C878;
        font-weight: bold;
        font-size: 1em;
        margin-top: 10px;
    }

    .hint {
        background: #FFF4E6;
        color: #9A6324;
        padding: 10px 15px;
        border-radius: 8px;
        font-size: 0.95em;
        margin-top: 10px;
        display: block;
        border-left: 4px solid #FFA94D;
    }

    .notearea {
        min-height: 120px;
        font-size:1em
    }

    .hidden {
        display:none
    }

    #essai1-count, #essai2-count {
        font-size: 0.95em;
        color: #666;
        margin-left:10px
    }

    /* LECTEURS AUDIO STYLIS√âS */
    audio {
        width: 100%;
        height: 50px;
        margin: 15px 0;
        border-radius: 12px;
        background: linear-gradient(135deg, #4A90E2 0%, #5B6FB5 100%);
        box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        outline: none;
    }

    audio::-webkit-media-controls-panel {
        background: linear-gradient(135deg, #4A90E2 0%, #5B6FB5 100%);
        border-radius: 12px;
    }

    audio::-webkit-media-controls-play-button,
    audio::-webkit-media-controls-mute-button {
        background-color: white;
        border-radius: 50%;
    }

    #dl-link {
        display: inline-block;
        margin-top: 15px;
        color: #4A90E2;
        font-weight: 600;
        text-decoration: none;
        font-size:1em
    }

    #dl-link:hover {
        text-decoration:underline
    }

    .export-buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        flex-wrap:wrap
    }

    .export-buttons button {
        margin-top:0
    }

    .final-section {
        background: linear-gradient(135deg, #FFA94D 0%, #FFB976 100%);
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        margin-top: 30px;
        box-shadow:0 5px 20px rgba(255, 169, 77, 0.3)
    }

    .final-section h2 {
        color: white;
        font-size: 1.8em;
        margin-bottom: 20px;
        text-shadow:2px 2px 4px rgba(0, 0, 0, 0.2)
    }

    .envelope-section {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-top:20px
    }

    .beatles-names {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top:15px
    }

    .beatles-names button {
        background: #5B6FB5;
        font-size: 1.1em;
        padding:15px 25px
    }

    .beatles-names button:hover {
        background:#4A5A96
    }

    .carte-mentale-box {
        background: #E8F5E9;
        padding: 25px;
        border-radius: 12px;
        border: 3px solid #50C878;
        margin-top: 20px;
        text-align: center;
    }

    .carte-mentale-box h3 {
        color: #2E7D32;
        font-size: 1.4em;
        margin-bottom: 15px;
    }

    .carte-mentale-box ul {
        text-align: left;
        display: inline-block;
        margin: 15px 0;
    }

    .carte-mentale-box li {
        margin: 8px 0;
        font-size: 1.05em;
    }

    .big-validate-btn {
        background: #50C878 !important;
        font-size: 1.3em !important;
        padding: 20px 40px !important;
        margin-top: 20px;
    }

    .big-validate-btn:hover {
        background: #3FB264 !important;
    }

    footer {
        text-align: center;
        margin-top: 50px;
        padding: 20px;
        color: white;
        font-size:0.9em
    }

    footer a {
        color: #FFD89B;
        text-decoration:none
    }

    footer a:hover {
        text-decoration:underline
    }

    .question-block {
        margin-bottom: 25px;
        padding: 20px;
        background: #FFF;
        border-radius: 10px;
        border-left: 4px solid #4A90E2;
    }

    @media (max-width: 768px) {
        body {
            padding: 0.5em;
            font-size:14px
        }

        .mission-intro h1 {
            font-size:1.6em
        }

        .music-icon {
            font-size:2em
        }

        .escape-icon {
            font-size:2em
        }

        .beatle {
            width: 45px;
            height:60px
        }

        h1 {
            font-size:1.5em
        }

        h2 {
            font-size:1.3em
        }

        .step {
            width: 55px;
            height: 55px;
            font-size:1.1em
        }

        .section, .mission-intro, .container, .indice-section, .timer-section {
            padding:15px 20px
        }

        .progression {
            gap:10px
        }

        .timer-display {
            font-size:2.5em
        }

        .timer-controls {
            flex-direction:column
        }

        .timer-controls button {
            width:100%
        }
    }

    @media (max-width: 480px) {
        .mission-intro h1 {
            font-size:1.4em
        }

        .step {
            width: 50px;
            height: 50px;
            font-size:1em
        }

        .export-buttons {
            flex-direction:column
        }

        .export-buttons button, .beatles-names button {
            width:100%
        }

        .timer-display {
            font-size: 2em
        }
    }
    </style>
</head>
<body>
    <div class="mission-intro">
        <div class="beatles-header">
            <span class="music-icon">üéµ</span>
            <h1>Mission pour le groupe 1 BEATLES</h1>
            <span class="music-icon">üé∂</span>
        </div>
        <div class="beatles-silhouette">
            <div class="beatle"></div>
            <div class="beatle"></div>
            <div class="beatle"></div>
            <div class="beatle"></div>
        </div>
        <div class="mission-text">
            <p>
                <strong>Bienvenue dans cette mission "La parole aux praticiens de la classe flexible"</strong>
            </p>
            <p>
                <strong>Vous devez en 20 minutes :</strong>
            </p>
            <ul>
                <li>üéß √âcouter les audios</li>
                <li>üìù Prendre des notes</li>
                <li>üîë Trouver les mots codes pour obtenir le message final et d√©couvrir l'enveloppe</li>
            </ul>
            <p>
                √Ä l'issue de l'√©coute, discutez de ce que vous avez d√©couvert et r√©alisez une 
                <strong>carte mentale</strong>
                 avec les points saillants du propos du chef d'√©tablissement.
            </p>
            <p>
                Puis partez √† la recherche du groupe 
                <strong>Rolling Stones</strong>
                 pour √©changer avec eux en vous tenant debout sur vos questions, d√©couvertes et r√©flexions.
            </p>
            <p style="text-align:center;font-size:1.2em;margin-top:15px">
                üé∏ 
                <strong>Bonne chance !</strong>
                 üé∏
            </p>
        </div>
    </div>
    <div class="timer-section">
        <h2 style="color:#4A90E2;margin-bottom:15px">‚è±Ô∏è Chronom√®tre de Mission</h2>
        <div class="timer-display" id="timer-display">20:00</div>
        <div class="timer-controls">
            <button id="start-btn" onclick="startTimer()">‚ñ∂Ô∏è D√©marrer</button>
            <button id="pause-btn" class="pause-btn" onclick="pauseTimer()" disabled>‚è∏Ô∏è Pause</button>
            <button id="reset-btn" class="reset-btn" onclick="resetTimer()">üîÑ R√©initialiser</button>
        </div>
        <p id="timer-status" style="margin-top:15px;font-size:1.1em;color:#666"></p>
    </div>
    <div class="indice-section">
        <div class="indice-header">
            <span class="escape-icon">üîì</span>
            <h2>Indices pour l'Escape Team</h2>
            <span class="escape-icon">üóùÔ∏è</span>
        </div>
        <div class="indice-content">
            <p>
                <strong>Si l'√©quipe Escape Team vous sollicite gentiment, vous pouvez leur donner cet indice :</strong>
            </p>
            <p style="font-size:1.2em;color:#F79A3E;font-weight:600;text-align:center;margin:20px 0">üí° Indice 1 : Regardez le labyrinthe apr√®s avoir trac√© les lignes et prenez du recul.</p>
            <div class="indice-warning">‚ö†Ô∏è Cet indice ne doit √™tre donn√© que si l'√©quipe le demande poliment !</div>
        </div>
    </div>
    <div class="container">
        <h1>La classe flexible : t√©moignage d'un chef d'√©tablissement</h1>
        <nav class="progression">
            <div class="step active" id="step1">1</div>
            <div class="step" id="step2">2</div>
            <div class="step" id="step3">3</div>
            <div class="step" id="step4">4</div>
        </nav>
        <div class="section" id="audio1-section">
            <h2>√âtape 1 : Premi√®re √©coute</h2>
            <audio id="audio1" controls src="audio1.mp3"></audio>
            <div class="question-block hidden" id="question-q1">
                <form onsubmit="return verifierClef1(this)" id="form-clef1">
                    <label>Quel adjectif est associ√© aux feuilles repositionnables ?</label>
                    <input type="text" id="input-clef1" placeholder="Entrez le mot..." autocomplete="off">
                    <button type="submit">Valider</button>
                    <span id="essai1-count"></span>
                    <div id="clef1-msg"></div>
                    <div id="clef1-hint" class="hint hidden"></div>
                </form>
            </div>
        </div>
        <div class="section hidden" id="audio2-section">
            <h2>√âtape 2 : Deuxi√®me √©coute</h2>
            <audio id="audio2" controls src="audio2.mp3"></audio>
            <div class="question-block hidden" id="question-q2">
                <form onsubmit="return verifierClef2(this)" id="form-clef2">
                    <label>Quel mot indique un travail coll√©gial entre √©l√®ves ?</label>
                    <input type="text" id="input-clef2" placeholder="Entrez le mot..." autocomplete="off">
                    <button type="submit">Valider</button>
                    <span id="essai2-count"></span>
                    <div id="clef2-msg"></div>
                </form>
            </div>
        </div>
        <div class="section hidden" id="audio3-section">
            <h2>√âtape 3 : Troisi√®me √©coute et mot code</h2>
            <audio id="audio3" controls src="audio3.mp3"></audio>
            <p>üìù √âcoutez attentivement pour d√©couvrir le mot code qui √©voque les diff√©rentes m√©thodes de travail au choix des √©l√®ves.</p>
            <div class="question-block hidden" id="question-q3">
                <form onsubmit="return verifierMotCode(this)" id="form-motcode">
                    <label>Quel est le mot code ? (Attention, la r√©ponse est en deux mots et au pluriel)</label>
                    <input type="text" id="input-motcode" placeholder="Entrez les deux mots..." autocomplete="off">
                    <button type="submit">Valider le mot code</button>
                    <div id="motcode-msg"></div>
                </form>
            </div>
        </div>
        
        <!-- CARTE MENTALE SIMPLIFI√âE -->
        <div class="section hidden" id="mindmap-section">
            <h2>√âtape 4 : Carte mentale et √©change</h2>
            
            <div class="carte-mentale-box">
                <h3>üìã Instructions pour la carte mentale</h3>
                <ul>
                    <li>‚úèÔ∏è Cr√©ez une carte mentale avec les points cl√©s du t√©moignage</li>
                    <li>üì∏ Prenez une photo de votre carte mentale</li>
                    <li>üë• Allez montrer votre travail au groupe <strong>Rolling Stones</strong></li>
                    <li>üí¨ √âchangez debout sur vos d√©couvertes et r√©flexions</li>
                </ul>
                
                <button onclick="validerCarteMentale()" class="big-validate-btn">‚úÖ J'ai cr√©√© ma carte mentale et √©chang√© avec le groupe Rolling Stones</button>
                
                <div id="validation-carte" class="success hidden" style="margin-top: 20px; font-size: 1.2em;"></div>
            </div>
        </div>

        <div class="section">
            <h2>Notes personnelles</h2>
            <textarea id="notes" class="notearea" placeholder="Prenez vos notes ici..."></textarea>
            <div id="notes-status"></div>
            <div class="export-buttons">
                <button onclick="exporterNotesTXT()">Exporter en TXT</button>
                <button onclick="exporterNotesPDF()">Exporter en PDF</button>
            </div>
        </div>
    </div>
    <div class="final-section hidden" id="final-section">
        <h2>üéâ F√âLICITATIONS ! üéâ</h2>
        <div class="envelope-section">
            <h3>üé∏ Mission accomplie ! üé∏</h3>
            <p style="font-size:1.2em;margin:20px 0">Vous avez termin√© toutes les √©tapes avec succ√®s !</p>
            <p style="font-size:1.1em;margin:20px 0">Envoyez un membre du groupe Beatles pour r√©cup√©rer l'enveloppe bonus !</p>
            <p style="font-weight:600;margin-bottom:15px">Qui va chercher l'enveloppe ?</p>
            <div class="beatles-names">
                <button onclick="envoyerBeatle('John')">üé§ John</button>
                <button onclick="envoyerBeatle('Paul')">üé∏ Paul</button>
                <button onclick="envoyerBeatle('Ringo')">ü•Å Ringo</button>
                <button onclick="envoyerBeatle('George')">üé∏ George</button>
            </div>
            <div id="envoi-msg" style="margin-top:20px;font-size:1.2em;font-weight:bold"></div>
        </div>
    </div>
    <footer>
        <p>
            Cr√©√© par 
            <strong>Am√©lie Silvert</strong>
            <br>
            DRANE Lille ‚Äì D√©l√©gation R√©gionale Acad√©mique au Num√©rique √âducatif
            <br>
            Acad√©mie de Lille
            <br>
            üìß 
            <a href="/cdn-cgi/l/email-protection#73121e161f1a165d001a1f051601073312105e1f1a1f1f165d1501"><span class="__cf_email__" data-cfemail="84e5e9e1e8ede1aaf7ede8f2e1f6f0c4e5e7a9e8ede8e8e1aae2f6">[email&#160;protected]</span></a>
        </p>
    </footer>
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
    let timerInterval = null,
        timeRemaining = 1200,
        isRunning = false;
    function updateTimerDisplay() {
        const e = Math.floor(timeRemaining / 60),
            t = timeRemaining % 60,
            n = document.getElementById("timer-display");
        n.textContent = `${String(e).padStart(2, "0")}:${String(t).padStart(2, "0")}`,
        timeRemaining <= 60 && timeRemaining > 0 ? n.className = "timer-display danger" : timeRemaining <= 300 && timeRemaining > 60 ? n.className = "timer-display warning" : n.className = "timer-display"
    }
    function startTimer() {
        isRunning || (isRunning = true, document.getElementById("start-btn").disabled = true, document.getElementById("pause-btn").disabled = false, document.getElementById("timer-status").innerHTML = '<span style="color:#50C878;font-weight:600">‚è±Ô∏è Chronom√®tre en cours...</span>', timerInterval = setInterval(() => {
            timeRemaining > 0 ? (timeRemaining--, updateTimerDisplay()) : (clearInterval(timerInterval), isRunning = false, document.getElementById("timer-status").innerHTML = '<span style="color:#E74C3C;font-weight:600">‚è∞ TEMPS √âCOUL√â !</span>')
        }, 1000))
    }
    function pauseTimer() {
        isRunning && (clearInterval(timerInterval), isRunning = false, document.getElementById("start-btn").disabled = false, document.getElementById("pause-btn").disabled = true, document.getElementById("timer-status").innerHTML = '<span style="color:#FFA94D;font-weight:600">‚è∏Ô∏è Chronom√®tre en pause</span>')
    }
    function resetTimer() {
        clearInterval(timerInterval),
        isRunning = false,
        timeRemaining = 1200,
        updateTimerDisplay(),
        document.getElementById("start-btn").disabled = false,
        document.getElementById("pause-btn").disabled = true,
        document.getElementById("timer-status").textContent = ""
    }
    function majProgression(e) {
        for (let t = 1; t <= 4; t++)
            document.getElementById("step" + t).className = "step" + (t <= e ? " active" : "")
    }
    const notesEl = document.getElementById("notes");
    function exporterNotesTXT() {
        const e = document.getElementById("notes").value;
        if (!e.trim())
            return void alert("Aucune note √† exporter !");
        const t = new Blob([e], {
                type: "text/plain"
            }),
            n = URL.createObjectURL(t),
            a = document.createElement("a");
        a.href = n,
        a.download = "mes_notes_classe_flexible.txt",
        a.click(),
        URL.revokeObjectURL(n)
    }
    function exporterNotesPDF() {
        const e = document.getElementById("notes").value;
        if (!e.trim())
            return void alert("Aucune note √† exporter !");
        const {jsPDF: t} = window.jspdf,
            n = new t;
        n.setFontSize(16),
        n.text("Mes notes - La classe flexible", 20, 20),
        n.setFontSize(12);
        const a = n.splitTextToSize(e, 170);
        n.text(a, 20, 35),
        n.save("mes_notes_classe_flexible.pdf")
    }
    notesEl.value = localStorage.getItem("lflex-notes") || "",
    notesEl.oninput = () => {
        localStorage.setItem("lflex-notes", notesEl.value),
        document.getElementById("notes-status").textContent = "Notes sauvegard√©es !",
        setTimeout(() => {
            document.getElementById("notes-status").textContent = ""
        }, 1500)
    };
    const audio1 = document.getElementById("audio1");
    audio1.addEventListener("ended", function() {
        document.getElementById("question-q1").classList.remove("hidden")
    });
    const audio2 = document.getElementById("audio2");
    audio2.addEventListener("ended", function() {
        document.getElementById("question-q2").classList.remove("hidden")
    });
    const audio3 = document.getElementById("audio3");
    function majEssais1() {
        document.getElementById("essai1-count").textContent = "Essais : " + essais1
    }
    audio3.addEventListener("ended", function() {
        document.getElementById("question-q3").classList.remove("hidden")
    });
    let essais1 = parseInt(localStorage.getItem("lflex-essais1") || "0");
    function verifierClef1(e) {
        const t = document.getElementById("input-clef1").value.trim().toLowerCase().replace(/[\s\-]/g, "");
        essais1++; localStorage.setItem("lflex-essais1", essais1); majEssais1();
        if (["electrostatique", "electrostatiques", "√©lectrostatique", "√©lectrostatiques"].includes(t)) {
            majProgression(2);
            document.getElementById("clef1-msg").innerHTML = '<span class="success">‚úÖ Bravo ! Passons √† la suite</span>';
            setTimeout(() => {
                document.getElementById("audio2-section").classList.remove("hidden");
                document.getElementById("audio2-section").scrollIntoView({behavior: "smooth"})
            }, 700);
            return false;
        }
        document.getElementById("clef1-msg").innerHTML = '<span class="error">‚ùå Non, essayez encore !</span>';
        if (essais1 >= 3) {
            document.getElementById("clef1-hint").classList.remove("hidden");
            document.getElementById("clef1-hint").textContent = "üí° Indice : les feuilles sont d√©tachables et d√©pla√ßables gr√¢ce √† une charge statique"
        }
        return false;
    }
    function majEssais2() {
        document.getElementById("essai2-count").textContent = "Essais : " + essais2
    }
    majEssais1();
    let essais2 = parseInt(localStorage.getItem("lflex-essais2") || "0");
    function verifierClef2(e) {
        const t = document.getElementById("input-clef2").value.trim().toLowerCase();
        essais2++; localStorage.setItem("lflex-essais2", essais2); majEssais2();
        if ("collaboratif" === t) {
            majProgression(3);
            document.getElementById("clef2-msg").innerHTML = '<span class="success">‚úÖ Bravo ! Passons √† la suite</span>';
            setTimeout(() => {
                document.getElementById("audio3-section").classList.remove("hidden");
                document.getElementById("audio3-section").scrollIntoView({behavior: "smooth"})
            }, 700);
            return false;
        }
        document.getElementById("clef2-msg").innerHTML = '<span class="error">‚ùå Non, essayez de nouveau !</span>';
        return false;
    }
    function verifierMotCode(e) {
        const t = document.getElementById("input-motcode").value.trim().toLowerCase().replace(/[\s\-']/g, "");
        if (["lesmodalites", "lesmodalit√©s", "modalites", "modalit√©s"].includes(t)) {
            document.getElementById("motcode-msg").innerHTML = '<span class="success">üéâ Excellent ! Vous avez trouv√© le mot code !</span>';
            majProgression(4);
            setTimeout(() => {
                document.getElementById("mindmap-section").classList.remove("hidden");
                document.getElementById("mindmap-section").scrollIntoView({behavior: "smooth"})
            }, 700);
            return false;
        }
        document.getElementById("motcode-msg").innerHTML = '<span class="error">‚ùå Ce n\'est pas le bon mot code. R√©√©coutez attentivement l\'audio !</span>';
        return false;
    }
    majEssais2();

    // VALIDATION CARTE MENTALE SIMPLIFI√âE
    function validerCarteMentale(){
        document.getElementById('validation-carte').innerHTML='üéâ <strong>Parfait ! Votre carte mentale et vos √©changes sont valid√©s !</strong>';
        document.getElementById('validation-carte').classList.remove('hidden');
        setTimeout(()=>{
            document.getElementById('final-section').classList.remove('hidden');
            document.getElementById('final-section').scrollIntoView({behavior:'smooth'});
        },1500);
    }
